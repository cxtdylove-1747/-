# iSulad Performance Testing Framework - Default Configuration

# Container engine configurations
engines:
  isulad:
    endpoint: "unix:///var/run/isulad.sock"
    timeout: 30
    retries: 3
    version: "latest"

  docker:
    endpoint: "unix:///var/run/docker.sock"
    timeout: 30
    retries: 3
    version: "latest"

  # CRI-O（如环境未安装，可用 containerd 作为 CRI 对比对象）
  crio:
    endpoint: "unix:///var/run/crio/crio.sock"
    timeout: 30
    retries: 3
    version: "latest"

  # containerd（CRI socket）
  containerd:
    endpoint: "unix:///run/containerd/containerd.sock"
    timeout: 30
    retries: 3
    version: "latest"

# Test configurations
tests:
  default_iterations: 10
  default_concurrency: 1
  default_duration: 60
  warmup_iterations: 5
  # 默认镜像：在线环境可用 busybox:latest；离线环境建议先导入后用 busybox:local
  # 建议填写“完整镜像名”，避免某些 CRI 运行时对短名解析不一致（尤其离线导入/本地 tag 场景）
  default_image: "docker.io/library/busybox:local"
  # CRI 生命周期类测试建议使用 pause 镜像（更稳定：启动后不会秒退，也不依赖 sh/tail/sleep）
  # 你之前已导入 pause:local 的话，默认用它即可。
  cri_lifecycle_image: "docker.io/library/pause:local"
  # CRI PodSandbox 使用 hostNetwork（跳过 CNI），在虚拟机/离线环境下更稳；如需测试 CNI 相关开销可改为 false
  cri_host_network: true

  # Specific test configurations
  create_container:
    iterations: 20
    concurrency: 1

  pull_image:
    iterations: 5
    concurrency: 1

  concurrent_operations:
    iterations: 50
    concurrency: 5

# Report configurations
report:
  output_dir: "./results"
  formats: ["console", "json"]
  include_charts: true
  include_raw_data: false

# Logging configuration
logging:
  level: "INFO"
  file: "isulad-perf.log"
  max_size: "10MB"
  backup_count: 5

# Performance thresholds (for anomaly detection)
thresholds:
  max_duration_threshold: 5.0  # seconds
  anomaly_sigma_threshold: 3.0  # standard deviations
  success_rate_threshold: 0.95  # 95%

# Benchmark configurations
benchmarks:
  standard_tests:
    - create_container
    - pull_image
    - start_container
    - list_containers

  # 离线/弱网环境推荐（不包含 pull_image / container_stats）
  standard_offline_tests:
    - create_container
    - start_container
    - list_containers

  extended_tests:
    - create_container
    - pull_image
    - start_container
    - stop_container
    - remove_container
    - list_containers
    - list_images
    - container_stats

  # 离线/弱网环境推荐（不包含 pull_image / container_stats）
  extended_offline_tests:
    - create_container
    - start_container
    - stop_container
    - remove_container
    - list_containers
    - list_images

  client_tests:
    - pull_image
    - create_container
    - start_container
    - exec_command
    - logs
    - remove_container

  # Client 离线/弱网环境推荐（不包含 pull_image）
  client_offline_tests:
    # 说明：exec/logs 依赖“长期运行的容器”，在部分精简 busybox 镜像环境下可能不稳定，
    # 因此默认离线套件先聚焦于更核心、更稳的生命周期与查询类操作。
    - create_container
    - start_container
    - logs
    - remove_container
    - list_containers
    - list_images

  # Client 扩展套件：包含 exec/logs（可能受测试镜像能力影响）
  client_extended_tests:
    - create_container
    - start_container
    - exec_command
    - logs
    - remove_container
    - list_containers
    - list_images
